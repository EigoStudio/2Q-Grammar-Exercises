<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‹±æ¤œ2ç´šæ–‡æ³• 19ç«  é–¢ä¿‚è©ã®åŸºæœ¬</title>
    <link href="https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary-pink: #ff80ab;
            --dark-pink: #c94b7b;
            --light-pink: #fce4ec;
            --bg-white: #ffffff;
            --text-black: #212121;
            --wrong-red: #ff1744;
            --en-font: "Hiragino Maru Gothic ProN", "Hiragino Maru Gothic Pro", "Yu Gothic", "Meiryo", sans-serif;
        }

        body {
            font-family: 'Kosugi Maru', var(--en-font);
            background-color: var(--light-pink);
            color: var(--text-black);
            display: flex; flex-direction: column; align-items: center; padding: 10px; margin: 0;
        }

        header { text-align: center; margin-bottom: 15px; width: 100%; max-width: 900px; }
        h1 { color: var(--dark-pink); margin: 10px 0; font-size: 1.5rem; }

        .container { 
            background: var(--bg-white); width: 98%; max-width: 800px; padding: 25px; 
            border-radius: 25px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); text-align: center; box-sizing: border-box; 
        }

        .question-box { font-size: 1.3rem; font-weight: bold; margin: 15px 0; padding: 20px; background: #fafafa; border-radius: 15px; border: 2px solid var(--primary-pink); line-height: 1.6; min-height: 80px; }
        
        .judge-btns { display: flex; justify-content: center; gap: 25px; margin-bottom: 20px; }
        .btn-judge { 
            width: 110px; height: 110px; border-radius: 50%; border: 4px solid #eee; 
            font-size: 1.8rem; font-weight: bold; cursor: pointer; transition: 0.2s; background: white;
            display: flex; align-items: center; justify-content: center;
        }
        .btn-ok { color: #4caf50; border-color: #4caf50; }
        .btn-ng { color: var(--wrong-red); border-color: var(--wrong-red); }
        .btn-judge:active { transform: scale(0.9); }

        .result-text { font-weight: bold; font-size: 2rem; margin: 10px 0; min-height: 40px; }
        
        .correction-area { display: none; margin-top: 20px; animation: fadeIn 0.4s; }
        .choice-btn { 
            display: block; width: 100%; max-width: 450px; margin: 12px auto; padding: 15px; 
            border: 2px solid #ffc1e3; border-radius: 30px; background: white; cursor: pointer; font-size: 1rem; font-family: inherit; font-weight: bold;
        }
        .choice-btn:hover { background: var(--light-pink); border-color: var(--primary-pink); }

        .correct-info { font-size: 1.1rem; color: #333; margin-top: 15px; background: #fff3f8; padding: 15px; border-radius: 15px; text-align: left; }
        .correct-info b { color: var(--dark-pink); }

        .next-btn { 
            display: none; background: var(--dark-pink); color: white; border: none; 
            padding: 15px 50px; border-radius: 40px; font-size: 1.2rem; cursor: pointer; margin-top: 20px; box-shadow: 0 4px 0 #880e4f;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        @media print {
            .no-print { display: none !important; }
            #printable-sheet { display: block !important; color: black; background: white; width: 100%; }
            .print-q { margin-bottom: 25px; border-bottom: none; padding-bottom: 10px; page-break-inside: avoid; }
            h2 { border-bottom: 2px solid black; }
        }
        #printable-sheet { display: none; }
    </style>
</head>
<body>

<header class="no-print">
    <h1>è‹±æ¤œ2ç´šæ–‡æ³• 19ç«  é–¢ä¿‚è©ã®åŸºæœ¬</h1>
    <div id="progress" style="font-size: 1rem; font-weight: bold; color: var(--dark-pink);">Question 1 / 20</div>
</header>

<div class="container no-print">
    <div id="resultMsg" class="result-text"></div>
    <div id="questionText" class="question-box">Loading...</div>
    
    <div id="judgeArea" class="judge-btns">
        <button class="btn-judge btn-ok" onclick="checkJudge(true)">OK</button>
        <button class="btn-judge btn-ng" onclick="checkJudge(false)">Ã—</button>
    </div>

    <div id="correctionArea" class="correction-area">
        <p style="font-weight: bold; color: var(--dark-pink);">ã©ã“ãŒé–“é•ã£ã¦ã„ã¾ã™ã‹ï¼Ÿæ­£ã—ã„ä¿®æ­£ã‚’é¸ã‚“ã§ã­ï¼</p>
        <div id="choicesGrid"></div>
    </div>

    <button id="nextBtn" class="next-btn" onclick="nextQuestion()">Next â†’</button>
    
    <div style="margin-top:30px;">
        <button onclick="window.print()" style="background:none; border:none; text-decoration:underline; cursor:pointer; color:#999; font-size:0.8rem;">ğŸ–¨ï¸ å­¦ç¿’ç”¨ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã‚’å°åˆ· (A4)</button>
    </div>
</div>

<div id="printable-sheet">
    <h2 style="text-align:center;">è‹±æ¤œ2ç´šæ–‡æ³• 19ç«  é–¢ä¿‚è©ã®åŸºæœ¬</h2>
    <p>â€»æ–‡ãŒæ­£ã—ã‘ã‚Œã°( OK )ã€é–“é•ã£ã¦ã„ã‚Œã°( Ã— )ã‚’æ›¸ãã€æ­£è§£ã®æ–‡ã‚’æ›¸ããªã•ã„ã€‚</p>
    <div id="print-content"></div>
</div>

<script>
const questions = [
    { s: "This is the boy who saved my cat.", ans: true },
    { s: "The man which is standing there is my uncle.", ans: false, choices: ["whoã«å¤‰ãˆã‚‹", "whomã«å¤‰ãˆã‚‹", "whoseã«å¤‰ãˆã‚‹"], correctPatterns: ["The man who is standing there is my uncle."] },
    { s: "I know a girl whose father is a famous pianist.", ans: true },
    { s: "She has a friend whom lives in London.", ans: false, choices: ["whoã«å¤‰ãˆã‚‹", "whichã«å¤‰ãˆã‚‹", "thatã«å¤‰ãˆã‚‹"], correctPatterns: ["She has a friend who lives in London."] },
    { s: "The house where I live in is very old.", ans: false, choices: ["whichã«å¤‰ãˆã‚‹", "whenã«å¤‰ãˆã‚‹", "whyã«å¤‰ãˆã‚‹"], correctPatterns: ["The house which I live in is very old.", "The house where I live is very old."] },
    { s: "Sunday is the day when I go to church.", ans: true },
    { s: "I don't know the reason why she is angry.", ans: true },
    { s: "This is how he solved the problem.", ans: true },
    { s: "My brother, who lives in New York, is a chef.", ans: true }, // éåˆ¶é™
    { s: "He gave me a watch, that was very expensive.", ans: false, choices: ["whichã«å¤‰ãˆã‚‹", "whoã«å¤‰ãˆã‚‹", "ã‚«ãƒ³ãƒã‚’æ¶ˆã™"], correctPatterns: ["He gave me a watch, which was very expensive."] }, // éåˆ¶é™
    { s: "She married a man who she met in Paris.", ans: true },
    { s: "This is the book whom I was looking for.", ans: false, choices: ["whichã«å¤‰ãˆã‚‹", "whoã«å¤‰ãˆã‚‹", "whoseã«å¤‰ãˆã‚‹"], correctPatterns: ["This is the book which I was looking for."] },
    { s: "The city where he was born is very beautiful.", ans: true },
    { s: "He failed the exam, which surprised us all.", ans: true }, // éåˆ¶é™
    { s: "Paris where is the capital of France is beautiful.", ans: false, choices: ["Paris, whichã«å¤‰ãˆã‚‹", "Paris, whereã«å¤‰ãˆã‚‹", "Paris whenã«å¤‰ãˆã‚‹"], correctPatterns: ["Paris, which is the capital of France, is beautiful."] }, // éåˆ¶é™
    { s: "I remember the time which we first met.", ans: false, choices: ["whenã«å¤‰ãˆã‚‹", "whereã«å¤‰ãˆã‚‹", "whyã«å¤‰ãˆã‚‹"], correctPatterns: ["I remember the time when we first met."] },
    { s: "The woman to who I spoke was very kind.", ans: false, choices: ["whomã«å¤‰ãˆã‚‹", "whoseã«å¤‰ãˆã‚‹", "whichã«å¤‰ãˆã‚‹"], correctPatterns: ["The woman to whom I spoke was very kind."] },
    { s: "That is the museum we visited last year.", ans: true },
    { s: "He is the only student that can speak French.", ans: true },
    { s: "The way how he talks is very polite.", ans: false, choices: ["The wayã‹howã®ã©ã¡ã‚‰ã‹ä¸€æ–¹ã«ã™ã‚‹", "way that howã«ã™ã‚‹", "how wayã«ã™ã‚‹"], 
      correctPatterns: ["The way he talks is very polite.", "How he talks is very polite."] }
];

let currentIdx = 0;

function loadQuestion() {
    const q = questions[currentIdx];
    document.getElementById('progress').textContent = `Question ${currentIdx + 1} / 20`;
    document.getElementById('questionText').innerHTML = q.s;
    document.getElementById('resultMsg').textContent = "";
    document.getElementById('correctionArea').style.display = 'none';
    document.getElementById('judgeArea').style.display = 'flex';
    document.getElementById('nextBtn').style.display = 'none';
}

function checkJudge(userAns) {
    const q = questions[currentIdx];
    const msg = document.getElementById('resultMsg');
    
    if (userAns === q.ans) {
        if (q.ans === true) {
            showSuccess();
        } else {
            showCorrectionStep();
        }
    } else {
        msg.style.color = 'var(--wrong-red)';
        msg.textContent = "Wrong!";
    }
}

function showCorrectionStep() {
    document.getElementById('judgeArea').style.display = 'none';
    document.getElementById('resultMsg').textContent = "";
    const area = document.getElementById('correctionArea');
    const grid = document.getElementById('choicesGrid');
    area.style.display = 'block';
    grid.innerHTML = "";
    
    const q = questions[currentIdx];
    // ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼ˆæ­£è§£ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ï¼‰
    const shuffled = [...q.choices].sort(() => Math.random() - 0.5);
    
    shuffled.forEach(choice => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = choice;
        btn.onclick = () => {
            if (choice === q.choices[0]) {
                showSuccess();
            } else {
                alert("é•ã†é¸æŠè‚¢ã‚’é¸ã‚“ã§ã¿ã‚ˆã†ï¼");
            }
        };
        grid.appendChild(btn);
    });
}

function showSuccess() {
    confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, colors: ['#ff80ab', '#ffffff', '#212121'] });
    const q = questions[currentIdx];
    const msg = document.getElementById('resultMsg');
    msg.style.display = 'block';
    msg.style.color = '#4caf50';
    msg.textContent = "Excellent! âœ¨";

    if (q.correctPatterns) {
        let html = `<div class="correct-info"><b>Correct Sentence:</b><br>`;
        q.correctPatterns.forEach(p => {
            html += `ãƒ» ${p}<br>`;
        });
        html += `</div>`;
        document.getElementById('questionText').innerHTML += html;
    }

    document.getElementById('correctionArea').style.display = 'none';
    document.getElementById('judgeArea').style.display = 'none';
    document.getElementById('nextBtn').style.display = 'inline-block';
}

function nextQuestion() {
    currentIdx++;
    if (currentIdx < questions.length) {
        loadQuestion();
    } else {
        document.getElementById('progress').textContent = "Goal!";
        document.querySelector('.container').innerHTML = "<h2 style='color:var(--dark-pink);'>Congratulations! ğŸŒ¸</h2><p style='font-size:1.2rem;'>è‹±æ¤œ2ç´š é–¢ä¿‚è©ã®åŸºæœ¬ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼</p><button onclick='location.reload()' class='next-btn' style='display:inline-block;'>ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>";
    }
}

function buildPrint() {
    const target = document.getElementById('print-content');
    questions.forEach((q, i) => {
        target.innerHTML += `
        <div class="print-q">
            <strong>Q${i+1}.</strong> ${q.s}<br>
            <div style="margin-top:10px;">åˆ¤å®š: (ã€€ã€€) </div>
            <div style="margin-top:10px; border-bottom: 1px dotted #ccc; height: 25px;">æ­£è§£ï¼š</div>
        </div>`;
    });
}

window.onload = () => {
    loadQuestion();
    buildPrint();
};
</script>
</body>
</html>